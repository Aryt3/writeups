# PHIlosophy

## Description
```
Clam decided to start studying philosophy, and what is the difference between plus one and minus one anyway...
```

## Provided Files
```
- chall.py
```

## Writeup


I started off by inspecting the given script. <br/>
```py
from Crypto.Util.number import getPrime
from secret import flag

p = getPrime(512)
q = getPrime(512)

m = int.from_bytes(flag.encode(), "big")

n = p * q
e = 65537
c = pow(m, e, n)

phi = (p + 1) * (q + 1)

print(f"n: {n}")
print(f"e: {e}")
print(f"c: {c}")
print(f"\"phi\": {phi}")

"""
n: 86088719452932625928188797700212036385645851492281481088289877829109110203124545852827976798704364393182426900932380436551569867036871171400190786913084554536903236375579771401257801115918586590639686117179685431627540567894983403579070366895343181435791515535593260495162656111028487919107927692512155290673
e: 65537
c: 64457111821105649174362298452450091137161142479679349324820456191542295609033025036769398863050668733308827861582321665479620448998471034645792165920115009947792955402994892700435507896792829140545387740663865218579313148804819896796193817727423074201660305082597780007494535370991899386707740199516316196758
"phi": 86088719452932625928188797700212036385645851492281481088289877829109110203124545852827976798704364393182426900932380436551569867036871171400190786913084573410416063246853198167436938724585247461433706053188624379514833802770205501907568228388536548010385588837258085711058519777393945044905741975952241886308
"""
```

The issue I saw within the script was the way in which `phi` is being calculated. <br/>
In `RSA` if we know `phi` we can simply decrypt the `ciphertext` using the method below. <br/>
```py
d = inverse(e, phi)

m = pow(c,d,N)
```

`Phi` is being calculated using `(p - 1) * (q - 1)`, but in the given code piece the `symbols` are wrong. <br/>
To reverse this we can simply change the given equation as we know `N` which is `p * q`. <br/>
```py
phi_correct = N - (phi_wrong - N - 1) + 1
```

Putting these pieces together we can make a script which retrieves the flag.
```py
from Crypto.Util.number import inverse, long_to_bytes
from sympy import symbols, Eq, solve

# Given values
c = 64457111821105649174362298452450091137161142479679349324820456191542295609033025036769398863050668733308827861582321665479620448998471034645792165920115009947792955402994892700435507896792829140545387740663865218579313148804819896796193817727423074201660305082597780007494535370991899386707740199516316196758
N = 86088719452932625928188797700212036385645851492281481088289877829109110203124545852827976798704364393182426900932380436551569867036871171400190786913084554536903236375579771401257801115918586590639686117179685431627540567894983403579070366895343181435791515535593260495162656111028487919107927692512155290673
e = 65537
phi_wrong = 86088719452932625928188797700212036385645851492281481088289877829109110203124545852827976798704364393182426900932380436551569867036871171400190786913084573410416063246853198167436938724585247461433706053188624379514833802770205501907568228388536548010385588837258085711058519777393945044905741975952241886308

# Calculate the correct phi
phi_correct = N - (phi_wrong - N - 1) + 1

d = inverse(e, phi_correct)

m = pow(c,d,N)

flag = long_to_bytes(m).decode()

print(flag)
```

Running the solution script revealed the flag `actf{its_okay_i_figured_out_phi_anyway}` which concludes this writeup.